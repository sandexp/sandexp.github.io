#### Class类文件的结构

1. 魔数以及版本号信息

   魔数用于表示当前字节码文件是Java虚拟机识别的文件，防止数据篡改的功能

   版本号信息存储了当前虚拟机的详细版本号新

2. 常量池

   常量池中主要存储字面量以及符号引用信息，常量池入口处需要标识常量池大小信息。

   常用的符号引用：

   + 被模块导出或者开发的包
   + 类或者接口的全限定名称
   + 字段名称和描述符
   + 方法名称和描述符
   + 方法句柄和方法类型
   + 动态调用点和动态常量

   常量池中不会存储具体的内存布局，只有当解析拿到直接引用时，才会确定内存布局。

3. 访问标记

   表示类或者接口的访问信息，包括权限修饰符，枚举信息，注解信息，模块信息等等。

4. 类索引，父类索引以及接口索引集合

   类索引和父类索引是u2类型数据，而接口索引集合是一组u2数据集合。

   类索引，父类索引以及接口索引集合排列在访问标志后面，其中类/父类索引使用u2型变量，指向常量池中的类标识符，通过类标识符信息在常量池中可以查找到全限定名信息。

5. 字段表集合

   字段表用于描述类或者接口中的变量信息，这里的变量指的是成员变量。

   字段表包括: 访问标记符，名称索引，描述符索引，属性个数以及相对应的属性信息组成。

6. 方法表集合

   与字段表集合的信息结构相似

7. 属性表集合

   只有属性名称不重复都可以写入属性集合中，且不强制要求顺序问题

#### 字节码指令集的设计

Java虚拟机的指令是一个字节的长度，且仅仅包含操作码，没有操作数信息，操作数存储在操作栈中。

##### 常用的虚拟机指令

1. 方法调用类

   + invokevirtual: 调用对象实例方法，根据实际情况进行指派
   + invokeinterface：调用接口方法，搜索一个实现了接口的对象并进行调用
   + invokespecial：调用特殊方法（初始化或者私有方法）
   + invokestatic：调用静态方法
   + invokedynamic：运行时解析并执行动态调用点限定符所引用的方法

2. 同步操作类

   synchronized关键字由monitorenter和monitorexit指令共同决定，用于方法或者静态代码块的逻辑同步中。

   